# 163邮箱IMAP配置指南

## 问题说明

当前遇到的错误：
```
SELECT Unsafe Login. Please contact kefu@188.com for help
```

这是163邮箱的安全限制，需要正确配置IMAP服务。

## 解决步骤

### 1. 登录163邮箱网页版
访问：https://mail.163.com
使用你的账号登录：15302814198@163.com

### 2. 开启IMAP/SMTP服务

1. 点击页面右上角的 **设置** 按钮
2. 选择 **POP3/SMTP/IMAP**
3. 找到 **IMAP/SMTP服务** 选项
4. 点击 **开启** 按钮

### 3. 获取授权码（重要！）

开启IMAP服务后，163会要求你设置"客户端授权密码"：

1. 按照提示发送短信验证
2. 系统会生成一个 **授权码**（16位字符）
3. **重要**：这个授权码就是你要在 `.env` 文件中使用的密码，不是你的邮箱登录密码！

### 4. 更新 .env 文件

将获取到的授权码更新到 `.env` 文件中：

```env
EMAIL_163_USERNAME=15302814198@163.com
EMAIL_163_PASSWORD=你的16位授权码
```

### 5. 安全设置（可选但推荐）

如果还是遇到"不安全登录"的问题：

1. 在163邮箱设置中找到 **客户端授权密码** 管理
2. 确认授权码状态为"已开启"
3. 在 **安全设置** 中，允许"客户端软件"访问

## 测试连接

配置完成后，运行测试脚本：

```bash
.\ai-email-coach-env\Scripts\python.exe test_imap.py
```

应该看到：
```
✅ 收件箱选择成功，共 XX 封邮件
✅ 找到 XX 封未读邮件
```

## 常见问题

### Q: 我已经有授权码了，为什么还是失败？
A: 可能是授权码过期或被禁用，建议重新生成一个新的授权码。

### Q: 找不到IMAP设置在哪里？
A: 163邮箱网页版 → 设置（右上角齿轮图标）→ POP3/SMTP/IMAP

### Q: 可以使用QQ邮箱代替吗？
A: 可以！QQ邮箱的IMAP服务更稳定。配置方法类似，也需要生成授权码。

## 当前状态

✅ IMAP连接成功
✅ 登录成功  
✅ 可以查看邮箱状态（47封邮件，23封未读）
❌ SELECT命令被阻止（需要正确的授权码）

## 下一步

1. 登录163邮箱网页版
2. 开启IMAP服务
3. 获取新的授权码
4. 更新 `.env` 文件中的 `EMAIL_163_PASSWORD`
5. 重新运行测试
