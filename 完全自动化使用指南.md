# 完全自动化使用指南

## 🎯 你的需求已实现！

现在系统完全自动化，你只需要**回复邮件**即可，不需要任何额外操作！

---

## 📧 完整工作流程

### 每天 22:00（晚上10点）

系统自动发送复盘提醒到：
- ✅ 你的邮箱：15302814198@163.com
- ✅ 你的飞书

邮件内容示例：
```
📊 每日复盘提醒

🌙 晚上好！今天的任务完成情况如何？

📋 今日任务清单：

🔄 用户登录功能
   进度：[■■■■■■■■□□] 80%
   象限: Q1

💬 请回复以下内容：
1. 今天完成了哪些任务？进度如何？
2. 明天计划做什么？
3. 有哪些任务需要暂缓？

示例：完成了用户登录功能80%，明天做数据库设计Q2任务

---
请直接回复此邮件更新任务进度
```

### 22:00-23:00（你的回复时间）

**你只需要做一件事：直接回复邮件！**

回复示例：
```
完成了用户登录功能90%，这是Q1任务
明天做数据库设计Q2任务
```

就这么简单！不需要去任何网站，不需要任何额外操作。

### 每天 23:00（晚上11点）

系统自动：
1. ✅ 检查你的邮件回复
2. ✅ 使用 AI 解析你的回复内容
3. ✅ 自动更新数据库
4. ✅ 发送反馈到飞书

飞书反馈示例：
```
📊 任务更新反馈

✅ 用户登录功能
   进度：[■■■■■■■■■□] 90%
   象限: Q1

🆕 数据库设计
   进度：[□□□□□□□□□□] 0%
   象限: Q2

💪 继续加油！
```

---

## 🎉 完全自动化！

你需要做的：
- ✅ 每天收到邮件后，直接回复邮件

系统自动完成：
- ✅ 每天 22:00 发送复盘提醒（邮件+飞书）
- ✅ 每天 23:00 检查邮件回复
- ✅ AI 自动解析回复内容
- ✅ 自动更新数据库
- ✅ 自动发送反馈到飞书
- ✅ 每周日 21:00 发送周报
- ✅ 每月1号 21:00 发送月报
- ✅ 24/7 云端运行，无需电脑开机

---

## 📝 回复格式

你可以用自然语言回复，AI 会自动识别：

### 示例 1：更新进度
```
完成了用户登录功能90%，这是Q1任务
```

### 示例 2：多个任务
```
完成了用户登录功能90%，这是Q1任务
完成了数据库设计50%，这是Q2任务
```

### 示例 3：暂缓任务
```
暂缓支付功能，这是Q3任务
```

### 示例 4：完成任务
```
完成了用户登录功能100%，这是Q1任务
```

AI 会自动识别：
- 任务名称
- 进度百分比
- 象限（Q1/Q2/Q3/Q4）
- 动作（更新/暂缓/完成）

---

## 🔧 配置步骤

### 1. 添加 GitHub Secret

你需要添加一个新的 Secret：

1. 前往：https://github.com/Zihui1112/ai-email-coach/settings/secrets/actions
2. 点击 **"New repository secret"**
3. Name: `EMAIL_163_PASSWORD`
4. Value: `JSewF34VrE5GGNwQ`（你的163邮箱授权码）
5. 点击 **"Add secret"**

### 2. 推送代码

运行以下命令（如果还没推送）：
```bash
git push
```

### 3. 测试

今晚 22:00 你会收到第一封复盘邮件，直接回复即可！

---

## 📊 时间线

```
22:00 → 收到复盘邮件（邮箱+飞书）
   ↓
22:00-23:00 → 你直接回复邮件
   ↓
23:00 → 系统自动检查邮件
   ↓
   → AI 解析回复内容
   → 更新数据库
   → 发送反馈到飞书
   ↓
完成！
```

---

## ✨ 优势

1. **完全自动化** - 只需回复邮件
2. **双渠道通知** - 邮件+飞书
3. **AI 智能解析** - 自然语言识别
4. **云端运行** - 无需电脑开机
5. **数据持久化** - Supabase 云数据库

---

## 🎯 就是这么简单！

从今天开始，你只需要：
1. 收到邮件
2. 回复邮件
3. 收到反馈

一切都是自动的！🚀


---

## 🐛 问题修复记录

### 2026-02-04 修复

**问题**：昨晚 check-reply workflow 出现错误
```
❌ 处理失败: 'NoneType' object has no attribute 'startswith'
```

**原因**：AI 解析回复时，某些字段（如 quadrant）可能返回 None 值，导致后续处理时调用 `startswith()` 方法失败。

**修复内容**：
- ✅ 增强了所有字段的验证逻辑
- ✅ 确保 quadrant 字段格式正确（必须是 Q1-Q4）
- ✅ 确保 progress 在 0-100 范围内
- ✅ 确保 action 只能是 update/pause/complete
- ✅ 所有字段都有安全的默认值

**影响**：
- 现在即使 AI 返回不完整的数据，系统也能正常处理
- 不会再出现 NoneType 错误
- 数据更加规范和可靠

---

## ⚠️ 关于定时任务

### GitHub Actions 定时任务说明

GitHub Actions 的 cron 定时任务有以下特点：

1. **可能有延迟**：通常延迟 5-15 分钟
2. **首次需要等待**：首次配置后可能需要 24 小时才会开始自动运行
3. **需要仓库活跃**：如果仓库长期不活跃，定时任务可能被暂停

### 如果今晚 22:00 没有收到邮件

**不要担心！** 这是正常的，因为：

1. **首次配置需要等待**：GitHub Actions 的定时任务首次配置后，可能需要等待 24 小时才会开始自动运行
2. **手动触发可以激活**：你可以手动触发一次，可能会激活定时任务

### 手动触发方法

1. 访问：https://github.com/Zihui1112/ai-email-coach/actions
2. 点击左侧的 **"每日复盘提醒"**
3. 点击右侧的 **"Run workflow"** 按钮
4. 点击绿色的 **"Run workflow"** 确认

这样你就能立即收到复盘邮件了！

### 监控运行状态

访问：https://github.com/Zihui1112/ai-email-coach/actions

可以看到：
- ✅ 绿色勾：运行成功
- ❌ 红色叉：运行失败
- 🟡 黄色圆：正在运行

点击任意运行记录可以查看详细日志。

---

## 📞 如果遇到问题

1. **查看 Actions 日志**：https://github.com/Zihui1112/ai-email-coach/actions
2. **检查 Secrets 配置**：确保所有 6 个 Secrets 都已正确配置
3. **手动触发测试**：先手动触发一次，确认功能正常
4. **等待 24 小时**：定时任务可能需要时间激活

---

## 🎉 总结

现在系统已经完全修复并优化，具备：
- ✅ 完全自动化运行
- ✅ 错误处理更加健壮
- ✅ 数据验证更加严格
- ✅ 双渠道通知（邮件+飞书）
- ✅ AI 智能解析
- ✅ 云端 24/7 运行

你只需要每天回复邮件，其他一切都自动完成！🚀
