# GitHub Actions 部署清单

## ✅ 快速部署步骤

### 第1步：创建GitHub仓库（5分钟）

- [ ] 访问 https://github.com
- [ ] 点击 "+" → "New repository"
- [ ] 仓库名：`ai-email-coach`
- [ ] 选择 Public
- [ ] 不勾选任何初始化选项
- [ ] 点击 "Create repository"
- [ ] 复制仓库地址（例如：`https://github.com/用户名/ai-email-coach.git`）

### 第2步：推送代码（2分钟）

**方式A：使用批处理文件（推荐）**
- [ ] 双击运行 `推送到GitHub.bat`
- [ ] 输入仓库地址
- [ ] 等待推送完成

**方式B：手动命令**
```bash
git add .
git commit -m "AI邮件督导系统"
git branch -M main
git remote add origin https://github.com/你的用户名/ai-email-coach.git
git push -u origin main
```

如果需要认证：
- [ ] 访问 https://github.com/settings/tokens
- [ ] 生成Personal Access Token
- [ ] 推送时使用token作为密码

### 第3步：配置Secrets（3分钟）

- [ ] 进入GitHub仓库 → Settings → Secrets and variables → Actions
- [ ] 点击 "New repository secret"，依次添加：

| Name | Value |
|------|-------|
| SUPABASE_URL | `https://cnmxhxapwksjczfxugtx.supabase.co` |
| SUPABASE_KEY | `eyJhbGc...`（你的完整key） |
| DEEPSEEK_API_KEY | `sk-86436...`（你的完整key） |
| FEISHU_WEBHOOK_URL | `https://open.feishu.cn/...`（你的完整URL） |
| EMAIL_163_USERNAME | `15302814198@163.com` |

### 第4步：启用Actions（1分钟）

- [ ] 进入 Settings → Actions → General
- [ ] 选择 "Allow all actions and reusable workflows"
- [ ] 点击 "Save"

### 第5步：测试（2分钟）

- [ ] 进入 Actions 标签
- [ ] 选择 "每日复盘提醒"
- [ ] 点击 "Run workflow"
- [ ] 选择 `main` 分支
- [ ] 点击 "Run workflow"
- [ ] 等待30秒
- [ ] 查看飞书群是否收到消息

---

## 🎯 测试所有功能

### 测试每日复盘
- [ ] Actions → "每日复盘提醒" → Run workflow
- [ ] 查看飞书：应收到任务清单

### 测试周报
- [ ] Actions → "每周报告" → Run workflow
- [ ] 查看飞书：应收到周报统计

### 测试月报
- [ ] Actions → "每月报告" → Run workflow
- [ ] 查看飞书：应收到月报统计

### 测试处理回复
- [ ] Actions → "处理用户回复" → Run workflow
- [ ] 输入：`完成了测试任务50%，这是Q1任务`
- [ ] 查看飞书：应收到AI反馈

---

## 📅 自动运行时间表

配置完成后，系统将自动运行：

| 功能 | 时间 | 频率 |
|------|------|------|
| 每日复盘 | 22:00 | 每天 |
| 周报 | 21:00 | 每周日 |
| 月报 | 21:00 | 每月1号 |

---

## 💬 日常使用流程

### 1. 接收提醒
- 每天22:00在飞书收到复盘提醒
- 查看今日任务完成情况

### 2. 回复更新
- 在飞书回复任务更新
- 例如：`完成了用户登录80%，明天做数据库设计Q2任务`

### 3. 处理回复
- 复制你的回复内容
- 进入GitHub → Actions → "处理用户回复"
- 点击 "Run workflow"
- 粘贴内容并运行

### 4. 查看反馈
- 等待30秒
- 在飞书查看AI生成的反馈
- 包含进度条、任务清单、个性化建议

---

## 🔧 常见问题

### ❌ 推送失败：authentication failed
**解决**：使用Personal Access Token代替密码
1. https://github.com/settings/tokens
2. Generate new token (classic)
3. 勾选 `repo` 权限
4. 复制token
5. 推送时用token作为密码

### ❌ Workflow运行失败
**解决**：检查Secrets配置
1. Settings → Secrets → 确认5个secrets都已添加
2. 检查值是否完整（没有多余空格）
3. 重新运行workflow

### ❌ 飞书没收到消息
**解决**：检查webhook
1. 测试飞书webhook是否有效
2. 运行本地测试：`python standalone_coach.py test`
3. 查看GitHub Actions运行日志

### ❌ 数据库权限错误
**解决**：已在Supabase执行过禁用RLS的SQL，应该不会再出现

---

## 📝 配置文件位置

| 文件 | 说明 |
|------|------|
| `.github/workflows/daily_review.yml` | 每日复盘配置 |
| `.github/workflows/weekly_report.yml` | 周报配置 |
| `.github/workflows/monthly_report.yml` | 月报配置 |
| `.github/workflows/process_reply.yml` | 处理回复配置 |
| `scripts/daily_review.py` | 每日复盘脚本 |
| `scripts/weekly_report.py` | 周报脚本 |
| `scripts/monthly_report.py` | 月报脚本 |
| `scripts/process_reply.py` | 处理回复脚本 |

---

## 🎉 完成！

全部完成后，你将拥有：
- ✅ 每天自动发送复盘提醒
- ✅ 每周自动发送周报
- ✅ 每月自动发送月报
- ✅ 手动处理任务更新回复
- ✅ 完全免费，无需服务器
- ✅ 24/7运行，不需要电脑开机

---

## 📞 需要帮助？

参考详细文档：
- `GitHub Actions完整部署指南.md` - 详细步骤说明
- `快速开始.md` - 本地运行说明
- `修复数据库权限.md` - 数据库问题解决

祝使用愉快！🚀
