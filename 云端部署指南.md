# AI邮件督导系统 - 云端部署指南

## 🎯 目标

实现一个**完全云端运行**的AI督导系统：
- ✅ 每晚22:00自动发送复盘提醒
- ✅ 随时接收和回复任务更新
- ✅ 不需要本地电脑运行
- ✅ 完全免费
- ✅ 支持国内访问

## 🚀 推荐方案：GitHub Actions + 飞书

### 优势
- ✅ 完全免费
- ✅ 无需服务器
- ✅ 自动定时执行
- ✅ 配置简单
- ✅ 支持国内访问（飞书）

### 限制
- ⚠️ 只能定时发送，不能实时回复
- ⚠️ 需要手动在飞书回复后，通过其他方式触发处理

---

## 📋 方案1：GitHub Actions（推荐）

### 步骤1：准备GitHub仓库

1. 将当前项目推送到GitHub
2. 进入仓库设置 Settings → Secrets and variables → Actions
3. 添加以下Secrets：

```
SUPABASE_URL=https://cnmxhxapwksjczfxugtx.supabase.co
SUPABASE_KEY=eyJhbGc...（你的key）
DEEPSEEK_API_KEY=sk-86436...（你的key）
FEISHU_WEBHOOK_URL=https://open.feishu.cn/...（你的webhook）
EMAIL_163_USERNAME=15302814198@163.com
```

### 步骤2：启用GitHub Actions

1. 项目已包含 `.github/workflows/daily_review.yml`
2. 推送代码后，GitHub Actions会自动启用
3. 每天22:00（北京时间）自动执行

### 步骤3：测试

1. 进入仓库的 Actions 标签页
2. 选择 "每日复盘提醒" workflow
3. 点击 "Run workflow" 手动触发测试
4. 查看飞书群是否收到消息

### 步骤4：手动处理回复

当你在飞书回复任务更新后：
1. 复制你的回复内容
2. 在GitHub Actions中手动触发 "处理用户消息" workflow
3. 或者创建一个简单的网页表单提交

---

## 📋 方案2：腾讯云函数（完全自动化）

### 优势
- ✅ 完全免费（每月100万次调用）
- ✅ 支持定时触发
- ✅ 支持HTTP触发（可接收飞书消息）
- ✅ 国内访问速度快

### 步骤1：注册腾讯云

1. 访问 https://cloud.tencent.com
2. 注册并完成实名认证
3. 进入云函数控制台

### 步骤2：创建云函数

1. 新建函数 → 从头开始
2. 函数名称：`ai-coach-daily-review`
3. 运行环境：Python 3.9
4. 函数代码：上传 `cloud_function_coach.py`

### 步骤3：配置环境变量

在函数配置中添加环境变量：
```
SUPABASE_URL=https://cnmxhxapwksjczfxugtx.supabase.co
SUPABASE_KEY=eyJhbGc...
DEEPSEEK_API_KEY=sk-86436...
FEISHU_WEBHOOK_URL=https://open.feishu.cn/...
EMAIL_163_USERNAME=15302814198@163.com
```

### 步骤4：配置定时触发器

1. 触发器管理 → 创建触发器
2. 触发方式：定时触发
3. Cron表达式：`0 22 * * *`（每天22:00）
4. 保存

### 步骤5：配置HTTP触发器（可选）

1. 创建API网关触发器
2. 获取触发URL
3. 在飞书机器人配置中设置该URL为回调地址
4. 实现自动回复功能

---

## 📋 方案3：飞书定时任务（最简单）

### 优势
- ✅ 最简单
- ✅ 完全在飞书内完成
- ✅ 无需额外配置

### 步骤1：创建飞书机器人

1. 进入飞书开放平台 https://open.feishu.cn
2. 创建企业自建应用
3. 添加机器人能力
4. 获取Webhook地址

### 步骤2：使用飞书工作流

1. 在飞书中创建"工作流"
2. 设置定时触发：每天22:00
3. 添加"发送消息"节点
4. 配置消息内容（复盘提醒）

### 步骤3：手动处理

- 收到复盘提醒后，手动回复
- 使用简单的Python脚本处理回复
- 或者使用飞书的"消息卡片"交互

---

## 🎯 最终推荐方案

### 方案A：GitHub Actions（适合技术用户）

**优点**：
- 完全免费
- 代码可控
- 易于调试

**缺点**：
- 不能实时回复
- 需要手动触发处理

**适合场景**：
- 只需要定时提醒
- 可以接受手动触发处理回复

### 方案B：腾讯云函数（适合完全自动化）

**优点**：
- 完全自动化
- 支持实时回复
- 国内访问快

**缺点**：
- 需要实名认证
- 配置稍复杂

**适合场景**：
- 需要完全自动化
- 希望实时回复

---

## 📝 当前配置

你的环境变量已配置：
```env
SUPABASE_URL=https://cnmxhxapwksjczfxugtx.supabase.co
SUPABASE_KEY=eyJhbGc...
DEEPSEEK_API_KEY=sk-86436...
FEISHU_WEBHOOK_URL=https://open.feishu.cn/open-apis/bot/v2/hook/902a2c44-8edc-4cb4-a7cd-c3d935c8ed8c
EMAIL_163_USERNAME=15302814198@163.com
```

---

## 🚀 快速开始（GitHub Actions）

### 1. 推送代码到GitHub

```bash
git init
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/你的用户名/ai-email-coach.git
git push -u origin main
```

### 2. 配置Secrets

进入GitHub仓库 → Settings → Secrets → 添加上述环境变量

### 3. 测试

进入Actions标签页 → 手动运行workflow → 查看飞书消息

### 4. 等待自动执行

每天22:00自动发送复盘提醒

---

## 💡 处理用户回复的方案

### 方案1：手动触发（最简单）

1. 在飞书回复任务更新
2. 复制回复内容
3. 在GitHub Actions中手动触发"处理消息"workflow
4. 粘贴内容并运行

### 方案2：邮件转发

1. 在飞书回复后，同时发送邮件到 15302814198@163.com
2. 使用之前的POP3脚本定期检查邮件
3. 自动处理并回复

### 方案3：飞书机器人回调（需要公网地址）

1. 部署云函数获取公网地址
2. 配置飞书机器人回调URL
3. 实现完全自动化

---

## 🎯 我的建议

根据你的需求（不需要一直检查邮件，定点发送和回复），我建议：

**最佳方案：GitHub Actions + 飞书 + 手动触发**

1. **定时发送**：GitHub Actions每天22:00自动发送复盘提醒到飞书
2. **回复处理**：你在飞书回复后，手动触发GitHub Actions处理
3. **完全免费**：无需任何费用
4. **简单可靠**：配置简单，易于维护

### 下一步

1. 我帮你把代码推送到GitHub
2. 配置GitHub Secrets
3. 测试定时任务
4. 创建一个简单的网页表单，方便你提交飞书回复内容

你觉得这个方案如何？
